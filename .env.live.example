# ==============================================================================
# Plane Live Server Environment Configuration for Dokploy
# ==============================================================================
# Copy this file and set in Dokploy's environment variables for the Live app
# Domain: plane.mohdop.com/live (served via path-based routing)
# Purpose: Real-time collaboration with WebSocket support
# ==============================================================================

# ==============================================================================
# TRAEFIK ROUTING (Required for Dokploy)
# ==============================================================================
# Frontend domain for path-based routing (Traefik will route /live to this service)
FRONTEND_DOMAIN=plane.mohdop.com

# ==============================================================================
# SERVER CONFIGURATION (Required)
# ==============================================================================
# Port for the live server
PORT=3000

# Node environment
NODE_ENV=production

# ==============================================================================
# BASE URLS (Required)
# ==============================================================================
# Backend API URL (internal docker service - for authentication and data sync)
# Use internal service name for docker-to-docker communication
API_BASE_URL=http://plane-api:8000

# Main web app URL
WEB_BASE_URL=https://plane.mohdop.com

# Live server public URL (same as web, accessed via /live path)
LIVE_BASE_URL=https://plane.mohdop.com

# Live server path
LIVE_BASE_PATH=/live

# ==============================================================================
# AUTHENTICATION (Required)
# ==============================================================================
# Secret key for JWT validation and WebSocket authentication
# IMPORTANT: This should match a shared secret with the API server
# Generate a secure random string (32+ characters)
LIVE_SERVER_SECRET_KEY=your-super-secret-live-key-change-this

# ==============================================================================
# REDIS CONFIGURATION (Required)
# ==============================================================================
# Redis connection for real-time state synchronization
# For Docker Redis (from docker-compose.infra.yml):
REDIS_HOST=plane-redis
REDIS_PORT=6379
REDIS_URL=redis://${REDIS_HOST}:${REDIS_PORT}/

# For external managed Redis (after migration):
# REDIS_URL=redis://username:password@your-redis-host:6379/
# REDIS_HOST=your-redis-host
# REDIS_PORT=6379

# ==============================================================================
# WEBSOCKET CONFIGURATION (Optional - has defaults)
# ==============================================================================
# WebSocket server settings
# Default: 30000ms (30 seconds)
WS_HEARTBEAT_INTERVAL=30000
WS_HEARTBEAT_TIMEOUT=90000

# Maximum connections per room
# Default: 100
MAX_CONNECTIONS_PER_ROOM=100

# ==============================================================================
# CORS CONFIGURATION (Required)
# ==============================================================================
# Allowed origins for WebSocket connections (comma-separated)
ALLOWED_ORIGINS=https://plane.mohdop.com

# ==============================================================================
# COLLABORATION ENGINE (Optional - has defaults)
# ==============================================================================
# Hocuspocus/Yjs configuration
# Document garbage collection interval (milliseconds)
# Default: 300000ms (5 minutes)
GC_INTERVAL=300000

# Document persistence interval (milliseconds)
# Default: 10000ms (10 seconds)
PERSIST_INTERVAL=10000

# ==============================================================================
# MONITORING (Optional)
# ==============================================================================
# Sentry DSN for error tracking
SENTRY_DSN=
SENTRY_ENVIRONMENT=production

# Enable debug logging
DEBUG=0

# ==============================================================================
# PERFORMANCE TUNING (Optional - has defaults)
# ==============================================================================
# Maximum payload size (bytes)
# Default: 10485760 (10MB)
MAX_PAYLOAD_SIZE=10485760

# Connection timeout (milliseconds)
# Default: 30000ms (30 seconds)
CONNECTION_TIMEOUT=30000
