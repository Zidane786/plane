# ==============================================================================
# Plane API Environment Configuration for Dokploy
# ==============================================================================
# Copy this file and set in Dokploy's environment variables for the API app
# Domain: api.yourdomain.com
# ==============================================================================

# ==============================================================================
# TRAEFIK ROUTING (Required for Dokploy)
# ==============================================================================
# Domain for the API service (used by Traefik for routing)
API_DOMAIN=plane-api.mohdop.com

# ==============================================================================
# DJANGO CONFIGURATION (Required)
# ==============================================================================
# Generate a secure secret key (50+ random characters)
# You can generate one using: python -c "from django.core.management.utils import get_random_secret_key; print(get_random_secret_key())"
SECRET_KEY=your-super-secret-key-here-change-this-in-production

# Debug mode - ALWAYS set to 0 in production
DEBUG=0

# Django settings module
DJANGO_SETTINGS_MODULE=plane.settings.production

# ==============================================================================
# DATABASE CONFIGURATION (Required)
# ==============================================================================
# PostgreSQL credentials (must match docker-compose.infra.yml)
POSTGRES_USER=plane
POSTGRES_PASSWORD=plane-db-password-change-this
POSTGRES_DB=plane

# For Docker PostgreSQL (from docker-compose.infra.yml):
PGUSER=${POSTGRES_USER}
PGPASSWORD=${POSTGRES_PASSWORD}
PGHOST=plane-postgres
PGDATABASE=${POSTGRES_DB}
DATABASE_URL=postgresql://${POSTGRES_USER}:${POSTGRES_PASSWORD}@plane-postgres:5432/${POSTGRES_DB}

# For external managed PostgreSQL (after migration):
# DATABASE_URL=postgresql://username:password@your-db-host:5432/plane

# ==============================================================================
# REDIS CONFIGURATION (Required)
# ==============================================================================
# For Docker Redis (from docker-compose.infra.yml):
REDIS_HOST=plane-redis
REDIS_PORT=6379
REDIS_URL=redis://${REDIS_HOST}:${REDIS_PORT}/

# For external managed Redis (after migration):
# REDIS_URL=redis://username:password@your-redis-host:6379/

# ==============================================================================
# RABBITMQ CONFIGURATION (Required)
# ==============================================================================
# RabbitMQ credentials (must match docker-compose.infra.yml)
RABBITMQ_USER=plane
RABBITMQ_PASSWORD=rabbitmq-password-change-this
RABBITMQ_VHOST=plane

# For Docker RabbitMQ (from docker-compose.infra.yml):
RABBITMQ_HOST=plane-rabbitmq
RABBITMQ_PORT=5672

# For external managed RabbitMQ (after migration):
# RABBITMQ_HOST=your-rabbitmq-host
# RABBITMQ_PORT=5672

# ==============================================================================
# CELERY CONFIGURATION (Required)
# ==============================================================================
# Celery broker URL
CELERY_BROKER_URL=amqp://${RABBITMQ_USER}:${RABBITMQ_PASSWORD}@${RABBITMQ_HOST}:${RABBITMQ_PORT}/${RABBITMQ_VHOST}

# ==============================================================================
# URLS & DOMAINS (Required)
# ==============================================================================
# Main web application URL
WEB_URL=https://plane.mohdop.com

# Admin/God Mode URL and path
ADMIN_BASE_URL=https://plane.mohdop.com
ADMIN_BASE_PATH=/god-mode

# Space (public view) URL and path
SPACE_BASE_URL=https://plane.mohdop.com
SPACE_BASE_PATH=/spaces

# Live collaboration server URL and path
LIVE_BASE_URL=https://plane.mohdop.com
LIVE_BASE_PATH=/live

# API URLs (used for CORS and redirects)
# Note: In Dokploy, this will be plane-api.mohdop.com
API_BASE_URL=https://plane-api.mohdop.com

# ==============================================================================
# CORS CONFIGURATION (Required)
# ==============================================================================
# Comma-separated list of allowed origins
CORS_ALLOWED_ORIGINS=https://plane.mohdop.com

# ==============================================================================
# FILE STORAGE CONFIGURATION (Required)
# ==============================================================================
# Storage backend: local or s3
USE_MINIO=1

# For Docker MinIO (from docker-compose.infra.yml):
AWS_REGION=us-east-1
AWS_ACCESS_KEY_ID=minioadmin
AWS_SECRET_ACCESS_KEY=minioadmin-password-change-this
AWS_S3_ENDPOINT_URL=http://plane-minio:9000
AWS_S3_BUCKET_NAME=uploads
FILE_SIZE_LIMIT=5242880
MINIO_ENDPOINT_SSL=0

# For external S3/DigitalOcean Spaces (after migration):
# USE_MINIO=0
# AWS_REGION=us-east-1  # or your region
# AWS_ACCESS_KEY_ID=your-access-key
# AWS_SECRET_ACCESS_KEY=your-secret-key
# AWS_S3_ENDPOINT_URL=https://your-bucket.s3.amazonaws.com  # Leave blank for AWS S3
# AWS_S3_BUCKET_NAME=your-bucket-name
# FILE_SIZE_LIMIT=52428800  # 50MB in bytes
# MINIO_ENDPOINT_SSL=1

# ==============================================================================
# GUNICORN CONFIGURATION (Optional - has defaults)
# ==============================================================================
# Number of worker processes (recommended: 2-4 Ã— CPU cores)
# Default: 2
GUNICORN_WORKERS=2

# ==============================================================================
# EMAIL CONFIGURATION (Optional)
# ==============================================================================
# Email backend
EMAIL_BACKEND=django.core.mail.backends.smtp.EmailBackend

# SMTP settings
EMAIL_HOST=smtp.gmail.com
EMAIL_PORT=587
EMAIL_USE_TLS=1
EMAIL_HOST_USER=your-email@gmail.com
EMAIL_HOST_PASSWORD=your-app-password
DEFAULT_FROM_EMAIL=noreply@yourdomain.com

# ==============================================================================
# AUTHENTICATION & SECURITY (Required)
# ==============================================================================
# Session cookie settings
SESSION_COOKIE_SECURE=1
CSRF_COOKIE_SECURE=1

# Allowed hosts (comma-separated)
ALLOWED_HOSTS=plane-api.mohdop.com,localhost

# ==============================================================================
# AI INTEGRATION (Optional)
# ==============================================================================
# OpenAI API key for AI features
OPENAI_API_KEY=your-openai-api-key

# GPT Model to use
GPT_ENGINE=gpt-4

# ==============================================================================
# ANALYTICS & MONITORING (Optional)
# ==============================================================================
# Scout APM monitoring
SCOUT_MONITOR=0
SCOUT_KEY=your-scout-key
SCOUT_NAME=Plane-API

# Analytics
ANALYTICS_BASE_API=

# ==============================================================================
# FEATURE FLAGS (Optional - have defaults)
# ==============================================================================
# Enable/disable features
# Default: All enabled
ENABLE_SIGNUP=1
ENABLE_EMAIL_PASSWORD=1
ENABLE_MAGIC_LINK_LOGIN=0

# ==============================================================================
# RATE LIMITING (Optional - has defaults)
# ==============================================================================
# Default: 60/minute
API_KEY_RATE_LIMIT=60/minute

# ==============================================================================
# DATA RETENTION (Optional - has defaults)
# ==============================================================================
# Days before hard deleting soft-deleted items
# Default: 60 days
HARD_DELETE_AFTER_DAYS=60

# ==============================================================================
# MISC CONFIGURATION (Optional)
# ==============================================================================
# License engine base URL (for enterprise features, optional)
LICENSE_ENGINE_BASE_URL=

# Instance key (for telemetry, optional)
INSTANCE_KEY=

# Unsplash access key (for image features, optional)
UNSPLASH_ACCESS_KEY=

# Sentry DSN (for error tracking, optional)
SENTRY_DSN=
SENTRY_ENVIRONMENT=production

# ==============================================================================
# DOKPLOY SPECIFIC
# ==============================================================================
# Port for the API server (Dokploy will map this)
PORT=8000

# Python environment
PYTHONUNBUFFERED=1
PYTHONDONTWRITEBYTECODE=1
