# ==============================================================================
# Plane Live Server - Environment Configuration
# ==============================================================================
# This file contains environment variables for the real-time collaboration server
# Handles WebSocket connections for collaborative editing (Hocuspocus/Yjs)
#
# SECURITY: Keep this file secure and NEVER commit to version control!
# ==============================================================================

# ==============================================================================
# TRAEFIK ROUTING (Dokploy) - REQUIRED
# ==============================================================================
# Frontend domain for path-based routing (/live path)
FRONTEND_DOMAIN=plane.mohdop.com

# ==============================================================================
# SERVER CONFIGURATION - REQUIRED
# ==============================================================================
PORT=3000
NODE_ENV=production

# ==============================================================================
# BASE URLS - REQUIRED
# ==============================================================================
# API URL - IMPORTANT: Use internal Docker network URL for backend communication!
# This allows the live server to validate JWTs with the API backend
API_BASE_URL=http://plane-api:8000

# Frontend URL (for CORS and client redirects)
WEB_BASE_URL=https://plane.mohdop.com

# Live Server URL (external URL for clients)
LIVE_BASE_URL=https://plane.mohdop.com
LIVE_BASE_PATH=/live

# ==============================================================================
# AUTHENTICATION - REQUIRED
# ==============================================================================
# CRITICAL: This MUST match the SECRET_KEY from .env.api!
# Used to validate JWT tokens issued by the API backend
LIVE_SERVER_SECRET_KEY=LtBkbgDqp-ZUlhkBjoO3kH6ftJpj6TcXR_w5HhKVsezQ_qK52pxAAUXokyJlwOUUh_U

# ==============================================================================
# REDIS CONFIGURATION - REQUIRED
# ==============================================================================
# Redis is used for real-time state synchronization and persistence
REDIS_HOST=plane-redis
REDIS_PORT=6379
REDIS_URL=redis://${REDIS_HOST}:${REDIS_PORT}/

# ==============================================================================
# WEBSOCKET CONFIGURATION - OPTIONAL
# ==============================================================================
# WebSocket heartbeat interval (milliseconds)
WS_HEARTBEAT_INTERVAL=30000

# WebSocket heartbeat timeout (milliseconds)
WS_HEARTBEAT_TIMEOUT=90000

# Maximum concurrent connections per room
MAX_CONNECTIONS_PER_ROOM=100

# ==============================================================================
# CORS CONFIGURATION - REQUIRED
# ==============================================================================
# Allow WebSocket connections from frontend domain
ALLOWED_ORIGINS=https://plane.mohdop.com

# ==============================================================================
# COLLABORATION ENGINE - OPTIONAL
# ==============================================================================
# Garbage collection interval for inactive documents (milliseconds)
GC_INTERVAL=300000

# Persistence interval for saving to Redis (milliseconds)
PERSIST_INTERVAL=10000

# ==============================================================================
# MONITORING - OPTIONAL
# ==============================================================================
# Sentry Error Tracking
SENTRY_DSN=
SENTRY_ENVIRONMENT=production
DEBUG=0

# ==============================================================================
# PERFORMANCE TUNING - OPTIONAL
# ==============================================================================
# Maximum WebSocket payload size (bytes) - 10MB default
MAX_PAYLOAD_SIZE=10485760

# Connection timeout (milliseconds)
CONNECTION_TIMEOUT=30000
